{% extends "layout/layout_auth.html" %}
{% block title %}Lupa Password - Amica Web{% endblock %}
{% block content %}
<div class="flex items-center justify-center min-h-screen px-4 py-8">
    <div class="w-full max-w-xl bg-white/80 dark:bg-gray-800/80 backdrop-blur-lg shadow-xl rounded-2xl overflow-hidden" 
         x-data="{ step: 1, email: '', password: '', confirmPassword: '', isLoading: false, passwordsMatch() { return this.password === this.confirmPassword && this.password.length > 0; } }">
        <div class="p-8 md:p-12 transition-all duration-300">
            <div x-show="step === 1" x-transition>
                <h1 class="text-3xl font-bold mb-2">Lupa Password</h1>
                <p class="font-light text-gray-500 dark:text-gray-400 mb-8">
                    Masukkan email Anda dan kami akan mengirimkan kode verifikasi.
                </p>
                <form @submit.prevent="isLoading = true; setTimeout(() => { step = 2; isLoading = false; }, 1500)">
                    <div class="py-3">
                        <label for="email" class="text-sm font-semibold">Email</label>
                        <input type="email" id="email" name="email" x-model="email" class="w-full mt-2 p-3 border border-gray-300 dark:border-gray-600 bg-white/50 dark:bg-gray-700/50 rounded-lg" required>
                    </div>
                    <button type="submit" :disabled="isLoading" class="flex items-center justify-center w-full bg-primary text-white font-bold p-3 rounded-lg mt-6 hover:bg-blue-600 transition transform hover:scale-105 disabled:bg-blue-300 dark:disabled:bg-blue-800">
                        <svg x-show="isLoading" class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
                        <span x-show="isLoading">Mengirim...</span>
                        <span x-show="!isLoading">Kirim Kode</span>
                    </button>
                </form>
            </div>
            <div x-show="step === 2" x-cloak x-transition>
                <h1 class="text-3xl font-bold mb-2">Verifikasi Kode</h1>
                <p class="font-light text-gray-500 dark:text-gray-400 mb-8">Masukkan kode 6 digit yang dikirim ke <span x-text="email" class="font-bold text-primary"></span></p>
                <form @submit.prevent="isLoading = true; setTimeout(() => { step = 3; isLoading = false; }, 1500)">
                    <div class="py-3">
                        <label for="code" class="text-sm font-semibold">Kode Verifikasi</label>
                        <input type="text" id="code" name="code" class="w-full text-center tracking-[1em] font-bold text-2xl mt-2 p-3 border border-gray-300 dark:border-gray-600 bg-white/50 dark:bg-gray-700/50 rounded-lg" maxlength="6" required pattern="\d{6}" title="Masukkan 6 digit kode angka.">
                    </div>
                    <button type="submit" :disabled="isLoading" class="flex items-center justify-center w-full bg-primary text-white font-bold p-3 rounded-lg mt-6 hover:bg-blue-600 transition transform hover:scale-105 disabled:bg-blue-300 dark:disabled:bg-blue-800">
                        <svg x-show="isLoading" class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
                        <span x-show="isLoading">Memverifikasi...</span>
                        <span x-show="!isLoading">Verifikasi</span>
                    </button>
                </form>
            </div>
            <div x-show="step === 3" x-cloak x-transition>
                <h1 class="text-3xl font-bold mb-2">Atur Password Baru</h1>
                <p class="font-light text-gray-500 dark:text-gray-400 mb-8">Password baru harus berbeda dari yang sebelumnya.</p>
                <form>
                    <div class="py-3">
                        <label for="new-password" class="text-sm font-semibold">Password Baru</label>
                        <input type="password" id="new-password" x-model="password" class="w-full mt-2 p-3 border border-gray-300 dark:border-gray-600 bg-white/50 dark:bg-gray-700/50 rounded-lg" required minlength="8" title="Minimal 8 karakter.">
                    </div>
                    <div class="py-3">
                        <label for="confirm-password" class="text-sm font-semibold">Konfirmasi Password Baru</label>
                        <input type="password" id="confirm-password" x-model="confirmPassword" class="w-full mt-2 p-3 border border-gray-300 dark:border-gray-600 bg-white/50 dark:bg-gray-700/50 rounded-lg" required>
                        <p x-show="confirmPassword && !passwordsMatch()" x-cloak class="text-red-500 text-xs mt-1">Password tidak cocok.</p>
                    </div>
                    <button type="submit" :disabled="!passwordsMatch()" class="w-full bg-primary text-white font-bold p-3 rounded-lg mt-6 hover:bg-blue-600 transition transform hover:scale-105 disabled:opacity-50">Simpan Password Baru</button>
                </form>
            </div>
            <div class="text-center mt-8">
                <a href="{{ url_for('web.login_page') }}" class="text-sm font-bold text-gray-500 dark:text-gray-400 hover:text-primary dark:hover:text-blue-400">&larr; Kembali ke Login</a>
            </div>
        </div>
    </div>
</div>
{% endblock %}